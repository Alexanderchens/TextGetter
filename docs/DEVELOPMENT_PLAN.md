# GetTheText 开发计划

## 总体策略

采用**自底向上**的开发顺序：先构建后端核心能力，再实现 API，最后完成前端。优先实现「本地文件 + 字幕/ASR」的端到端流程，确保 MVP 可跑通，再逐步扩展平台和功能。

---

## Phase 1: 项目骨架与数据层

**目标**：搭建后端结构，完成数据库与基础模型

| 任务 | 说明 | 预估 |
|------|------|------|
| 1.1 后端项目初始化 | FastAPI、目录结构、requirements.txt | - |
| 1.2 数据模型 | Task、TaskResult、SQLAlchemy 模型 | - |
| 1.3 数据库初始化 | SQLite、建表、Repository 层 | - |
| 1.4 配置管理 | 环境变量、config 模块 | - |

**产出**：可启动的空后端，DB 可读写

---

## Phase 2: 平台解析器 + 本地适配器

**目标**：能识别并处理本地视频/图片

| 任务 | 说明 | 预估 |
|------|------|------|
| 2.1 平台解析器接口 | IPlatformParser、PlatformParseResult、Registry | - |
| 2.2 LocalAdapter | 本地路径识别、文件校验、媒体类型判断 | - |
| 2.3 存储服务 | 媒体缓存目录、任务工作目录 | - |

**产出**：传入本地路径可返回 MediaResource

---

## Phase 3: 文案提取器

**目标**：从视频中提取文案（字幕 + ASR）

| 任务 | 说明 | 预估 |
|------|------|------|
| 3.1 字幕提取器 | SRT/VTT 解析、ffmpeg 提取内嵌字幕 | - |
| 3.2 ASR 提取器 | 音频提取、Whisper 集成 | - |
| 3.3 合并器 | 多源合并、去重、按时间排序 | - |
| 3.4 提取流水线 | ExtractPipeline 编排 | - |

**产出**：给定视频路径，可输出完整文案

---

## Phase 4: 任务编排器

**目标**：串联解析→下载→提取→存储

| 任务 | 说明 | 预估 |
|------|------|------|
| 4.1 任务执行器 | 状态机、各阶段切换 | - |
| 4.2 进度回调 | 更新 DB、支持 WebSocket 预留 | - |
| 4.3 异步执行 | 后台线程/进程执行任务 | - |

**产出**：创建任务后自动执行并更新进度

---

## Phase 5: API 网关

**目标**：提供 REST 接口供前端调用

| 任务 | 说明 | 预估 |
|------|------|------|
| 5.1 任务 API | POST/GET tasks、取消、列表 | - |
| 5.2 文件上传 | 支持 multipart 上传视频 | - |
| 5.3 导出 API | 返回 Markdown/TXT | - |
| 5.4 错误处理 | 统一错误码、异常捕获 | - |

**产出**：前端可通过 API 完成完整流程

---

## Phase 6: 前端基础

**目标**：可用的 Web 界面

| 任务 | 说明 | 预估 |
|------|------|------|
| 6.1 项目初始化 | React + Vite + Tailwind | - |
| 6.2 首页 | 链接输入、文件上传、创建任务 | - |
| 6.3 提取详情页 | 进度展示、文案展示 | - |
| 6.4 历史列表 | 任务列表、跳转详情 | - |
| 6.5 导出 | 复制、Markdown 下载 | - |

**产出**：用户可通过界面完成提取全流程

---

## Phase 7: 扩展与优化（后续迭代）

| 任务 | 说明 |
|------|------|
| ~~7.1 B 站适配器~~ | ~~yt-dlp 集成~~ ✅ 已实现 |
| 7.2 OCR 提取器 | PaddleOCR、关键帧采样 |
| 7.3 WebSocket 实时进度 | 替代轮询 |
| 7.4 更多平台 | 抖音、快手等 |
| 7.5 LLM 清洗 | 可选润色 |
| 7.6 Docker 部署 | docker-compose 一键启动 |

---

## 当前进度

- [x] Phase 1: 项目骨架与数据层
- [x] Phase 2: 平台解析器 + 本地适配器
- [x] Phase 3: 文案提取器
- [x] Phase 4: 任务编排器
- [x] Phase 5: API 网关
- [x] Phase 6: 前端基础
- [ ] Phase 7: 扩展与优化
